load("/home/iaradsouza/part_1/analysis/c_elegans/table_root_celegans.RData")
# table plot
table_plot_celegans <- bind_rows(table_merged_lethal_cog_root, table_merged_nonlethal_cog_root)
library(dplyr)
# table plot
table_plot_celegans <- bind_rows(table_merged_lethal_cog_root, table_merged_nonlethal_cog_root)
table_plot_celegans$organism <- "celegans"
save(table_plot_celegans, file = "table_plot_celegans.RData")
load("/home/iaradsouza/part_1/analysis/c_elegans/table_root_celegans.RData")
load("/home/iaradsouza/part_1/analysis/c_elegans/table_root_celegans.RData")
# Add a new column with lethal and non-lethal
table_merged_lethal_cog_root$lethal_nonlethal <- "lethal"
table_merged_nonlethal_cog_root$lethal_nonlethal <- "nonlethal"
# table plot
table_plot_celegans <- bind_rows(table_merged_lethal_cog_root, table_merged_nonlethal_cog_root)
table_plot_celegans$organism <- "celegans"
# Add a new column with lethal and non-lethal
table_merged_lethal_cog_root$lethal_nonlethal <- "lethal"
table_merged_nonlethal_cog_root$lethal_nonlethal <- "nonlethal"
# table plot
table_plot_celegans <- bind_rows(table_merged_lethal_cog_root, table_merged_nonlethal_cog_root)
library(dplyr)
# table plot
table_plot_celegans <- bind_rows(table_merged_lethal_cog_root, table_merged_nonlethal_cog_root)
table_plot_celegans$organism <- "celegans"
View(table_plot_celegans)
save(table_plot_celegans, file = "table_plot_celegans.RData")
# Caenorhabditis elegans --------------------------------------------------
setwd("~/part_1/analysis/c_elegans/")
# Retrieve COG ids
load("../../geneplast_objects/geneplastData.RData")
View(cogdata)
load("/home/iaradsouza/part_1/analysis/c_elegans/geneplast_results_celegans.RData")
View(ogp_celegans_lethal)
load("/home/iaradsouza/part_1/analysis/c_elegans/celegans_plot.RData")
View(celegans_plot)
View(celegans_plot)
View(celegans_plot)
load("/home/iaradsouza/part_1/analysis/c_elegans/table_root_celegans.RData")
View(table_merged_lethal_cog_root)
View(table_merged_nonlethal_cog_root)
load("/home/iaradsouza/part_1/analysis/c_elegans/table_plot_celegans.RData")
load("/home/iaradsouza/part_1/analysis/c_elegans/table_plot_celegans.RData")
View(table_plot_celegans)
load("/home/iaradsouza/part_1/analysis/c_elegans/table_plot_celegans.RData")
View(table_plot_celegans)
load("/home/iaradsouza/part_1/analysis/table_all_org.RData")
View(table)
View(table)
load("/home/iaradsouza/part_1/analysis/table_all_org.RData")
View(table)
quantile(table[table$organism == "celegans"])
quantile(table$Root[table$organism == "celegans"],probs = 0.1 )
quantile(table$Root[table$organism == "celegans"],probs = 0.9 )
quantile(table$Root[table$organism == "celegans"],probs = 0.2 )
quantile(table$Root[table$organism == "celegans"],probs = 0.3 )
quantile(table$Root[table$organism == "celegans"],probs = 0.4 )
quantile(table$Root[table$organism == "celegans"],probs = 0.5 )
quantile(table$Root[table$organism == "celegans"],probs = 0.1 )
quantile(table$Root[table$organism == "celegans"],probs = 0.2 )
setwd("~/part_1/submission/essential_genes_paper")
load("/home/iaradsouza/part_1/submission/essential_genes_paper/scripts_geneplast/geneplast_objects/geneplastData.RData")
class(phyloTree)
setwd("~/part_1/submission/essential_genes_paper")
ontology <- read_delim("scripts_geneplast/mouse/mammalian_ontology.txt", delim = "\t",
col_names = c("mp_id", "description", "details"),
col_types = "ccc")
mouse_geno <- read_delim("datasets/MGI_PhenoGenoMP.rpt",
delim = "\t", col_names = c("allelic_composition", "allele_symbol",
"genetic_backgrond", "mp_id", "pubmed_id",
"mgi_id"))
library(dplyr)
# read table
library(readr)
ontology <- read_delim("scripts_geneplast/mouse/mammalian_ontology.txt", delim = "\t",
col_names = c("mp_id", "description", "details"),
col_types = "ccc")
mouse_geno <- read_delim("datasets/MGI_PhenoGenoMP.rpt",
delim = "\t", col_names = c("allelic_composition", "allele_symbol",
"genetic_backgrond", "mp_id", "pubmed_id",
"mgi_id"))
# read table of defined categories
# in this list, I excluded the ontology MP:0010831 because it was very unnespecific.
ontologies_lethal_categories <- read_delim(
file = "scripts_geneplast/mouse/ontologies_lethal_categories.txt", delim = "\t")
# I decided to eliminate the ontologies related with 'incomplete penetrance' and
# the ones not well defined
idx <- grep('incomplete penetrance', ontologies_lethal_categories$description)
ontologies_lethal_categories <- ontologies_lethal_categories[-idx, ]
idx <- grep(',', ontologies_lethal_categories$categories)
ontologies_lethal_categories <- ontologies_lethal_categories[-idx, ]
# merge tables of lethal genes and ontologies
lethal_genes_table <- inner_join(table_merged_lethal, ontologies_lethal_categories,
by = c("mp_id" = "mp.id"))
# final list of lethal genes
lethal_genes <- unique(lethal_genes_table$mgi_id)
ontology <- read_delim("scripts_geneplast/mouse/mammalian_ontology.txt", delim = "\t",
col_names = c("mp_id", "description", "details"),
col_types = "ccc")
mouse_geno <- read_delim("datasets/MGI_PhenoGenoMP.rpt",
delim = "\t", col_names = c("allelic_composition", "allele_symbol",
"genetic_backgrond", "mp_id", "pubmed_id",
"mgi_id"))
library(dplyr)
table_merged <- inner_join(ontology, mouse_geno, by = "mp_id")
# get one gene per row
library(tidyr)
table_merged <- mutate(table_merged,
mgi_id = strsplit(as.character(mgi_id), ","))
table_merged <- unnest(table_merged, mgi_id )
# filter by lethality
idx <- grep('lethal', table_merged$description)
table_merged_lethal <- table_merged[idx, ]
# read table of defined categories
# in this list, I excluded the ontology MP:0010831 because it was very unnespecific.
ontologies_lethal_categories <- read_delim(
file = "scripts_geneplast/mouse/ontologies_lethal_categories.txt", delim = "\t")
# I decided to eliminate the ontologies related with 'incomplete penetrance' and
# the ones not well defined
idx <- grep('incomplete penetrance', ontologies_lethal_categories$description)
ontologies_lethal_categories <- ontologies_lethal_categories[-idx, ]
idx <- grep(',', ontologies_lethal_categories$categories)
ontologies_lethal_categories <- ontologies_lethal_categories[-idx, ]
# merge tables of lethal genes and ontologies
lethal_genes_table <- inner_join(table_merged_lethal, ontologies_lethal_categories,
by = c("mp_id" = "mp.id"))
# final list of lethal genes
lethal_genes <- unique(lethal_genes_table$mgi_id)
# table of non-lethal genes
nonlethal_genes_table <- anti_join(table_merged, lethal_genes_table, by = "mgi_id")
# final list of non-lethal genes
nonlethal_genes <- unique(nonlethal_genes_table$mgi_id)
View(ontologies_lethal_categories)
write.csv(file = "ontologies_lethal_categories_final.csv", quote = F, row.names = F)
write.csv(ontologies_lethal_categories,
file = "scripts_geneplast/mouse/ontologies_lethal_categories_final.csv",
quote = F, row.names = F)
